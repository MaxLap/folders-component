{"version":3,"sources":["app.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","module","ComponentManager","permissions","onReady","sentMessages","messageQueue","loggingEnabled","onReadyCallback","window","addEventListener","event","console","log","data","handleMessage","bind","payload","action","sessionKey","componentData","activateThemes","themes","original","originalMessage","filter","message","messageId","callback","postMessage","key","value","push","generateUUID","api","sentMessage","JSON","parse","stringify","parent","type","width","height","content_types","tags","items","item","jsonObjectForItem","associateItem","content_type","deleteItems","params","map","saveItems","copy","Object","assign","children","urls","deactivateAllCustomThemes","url","link","document","createElement","href","rel","media","className","getElementsByTagName","appendChild","elements","getElementsByClassName","forEach","element","disabled","parentNode","removeChild","crypto","msCrypto","buf","Uint32Array","getRandomValues","idx","replace","c","v","toString","d","Date","getTime","performance","now","uuid","Math","random","floor","angular","HomeCtrl","$rootScope","$scope","$timeout","name","componentManager","delimiter","resolveRawTags","resolved","masterTag","rawTags","slice","findResolvedTag","title","tag","content","comps","split","displayTitle","parentTitle","join","sort","b","index","indexOf","splice","changeParent","sourceId","targetId","source","target","needsSave","adjustChildren","child","newTitle","master","createTag","dummy","createItem","selectTag","clearSelection","selectItem","selectedTag","selected","editing","saveTags","streamItems","newTags","allTags","existing","tagCandidate","onTrashDrop","tagId","deleteChain","addChildren","$$ngIsClass","controller","directive","restrict","scope","shouldFocus","$element","focus","drop","isDraggable","attrs","el","draggable","counter","dataTransfer","effectAllowed","setData","classList","add","remove","dropEffect","preventDefault","stopPropagation","getData","$apply","TagTree","templateUrl","onSelect","onDrop","onDragOver","onDragStart","addChild","unshift","saveNewTag","saveTagRename","renameChildren","generationForTag","generation"],"mappings":"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","file":"app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nclass ComponentManager {\n\n  constructor(permissions, onReady) {\n    this.sentMessages = [];\n    this.messageQueue = [];\n    this.permissions = permissions;\n    this.loggingEnabled = false;\n    this.onReadyCallback = onReady;\n\n    window.addEventListener(\"message\", function (event) {\n      if (this.loggingEnabled) {\n        console.log(\"Components API Message received:\", event.data);\n      }\n      this.handleMessage(event.data);\n    }.bind(this), false);\n  }\n\n  handleMessage(payload) {\n    if (payload.action === \"component-registered\") {\n      this.sessionKey = payload.sessionKey;\n      this.componentData = payload.componentData;\n      this.onReady();\n\n      if (this.loggingEnabled) {\n        console.log(\"Component successfully registered with payload:\", payload);\n      }\n    } else if (payload.action === \"themes\") {\n      this.activateThemes(payload.data.themes);\n    } else if (payload.original) {\n      // get callback from queue\n      var originalMessage = this.sentMessages.filter(function (message) {\n        return message.messageId === payload.original.messageId;\n      })[0];\n\n      if (originalMessage.callback) {\n        originalMessage.callback(payload.data);\n      }\n    }\n  }\n\n  onReady() {\n    for (var message of this.messageQueue) {\n      this.postMessage(message.action, message.data, message.callback);\n    }\n    this.messageQueue = [];\n\n    if (this.onReadyCallback) {\n      this.onReadyCallback();\n    }\n  }\n\n  setComponentDataValueForKey(key, value) {\n    this.componentData[key] = value;\n    this.postMessage(\"set-component-data\", { componentData: this.componentData }, function (data) {});\n  }\n\n  clearComponentData() {\n    this.componentData = {};\n    this.postMessage(\"set-component-data\", { componentData: this.componentData }, function (data) {});\n  }\n\n  componentDataValueForKey(key) {\n    return this.componentData[key];\n  }\n\n  postMessage(action, data, callback) {\n    if (!this.sessionKey) {\n      this.messageQueue.push({\n        action: action,\n        data: data,\n        callback: callback\n      });\n      return;\n    }\n\n    var message = {\n      action: action,\n      data: data,\n      messageId: this.generateUUID(),\n      sessionKey: this.sessionKey,\n      permissions: this.permissions,\n      api: \"component\"\n    };\n\n    var sentMessage = JSON.parse(JSON.stringify(message));\n    sentMessage.callback = callback;\n    this.sentMessages.push(sentMessage);\n\n    if (this.loggingEnabled) {\n      console.log(\"Posting message:\", message);\n    }\n\n    window.parent.postMessage(message, '*');\n  }\n\n  setSize(type, width, height) {\n    this.postMessage(\"set-size\", { type: type, width: width, height: height }, function (data) {});\n  }\n\n  streamItems(callback) {\n    this.postMessage(\"stream-items\", { content_types: [\"Tag\"] }, function (data) {\n      var tags = data.items;\n      callback(tags);\n    }.bind(this));\n  }\n\n  streamContextItem(callback) {\n    this.postMessage(\"stream-context-item\", null, function (data) {\n      var item = data.item;\n      callback(item);\n    }.bind(this));\n  }\n\n  selectItem(item) {\n    this.postMessage(\"select-item\", { item: this.jsonObjectForItem(item) });\n  }\n\n  createItem(item) {\n    this.postMessage(\"create-item\", { item: this.jsonObjectForItem(item) }, function (data) {\n      var item = data.item;\n      this.associateItem(item);\n    }.bind(this));\n  }\n\n  associateItem(item) {\n    this.postMessage(\"associate-item\", { item: this.jsonObjectForItem(item) });\n  }\n\n  deassociateItem(item) {\n    this.postMessage(\"deassociate-item\", { item: this.jsonObjectForItem(item) });\n  }\n\n  clearSelection() {\n    this.postMessage(\"clear-selection\", { content_type: \"Tag\" });\n  }\n\n  deleteItem(item) {\n    this.deleteItems([item]);\n  }\n\n  deleteItems(items) {\n    var params = {\n      items: items.map(function (item) {\n        return this.jsonObjectForItem(item);\n      }.bind(this))\n    };\n    this.postMessage(\"delete-items\", params);\n  }\n\n  saveItem(item) {\n    this.saveItems([item]);\n  }\n\n  saveItems(items) {\n    items = items.map(function (item) {\n      return this.jsonObjectForItem(item);\n    }.bind(this));\n\n    this.postMessage(\"save-items\", { items: items }, function (data) {});\n  }\n\n  jsonObjectForItem(item) {\n    var copy = Object.assign({}, item);\n    copy.children = null;\n    copy.parent = null;\n    return copy;\n  }\n\n  /* Themes */\n\n  activateThemes(urls) {\n    this.deactivateAllCustomThemes();\n\n    if (this.loggingEnabled) {\n      console.log(\"Activating themes:\", urls);\n    }\n\n    if (!urls) {\n      return;\n    }\n\n    for (var url of urls) {\n      if (!url) {\n        continue;\n      }\n\n      var link = document.createElement(\"link\");\n      link.href = url;\n      link.type = \"text/css\";\n      link.rel = \"stylesheet\";\n      link.media = \"screen,print\";\n      link.className = \"custom-theme\";\n      document.getElementsByTagName(\"head\")[0].appendChild(link);\n    }\n  }\n\n  deactivateAllCustomThemes() {\n    var elements = document.getElementsByClassName(\"custom-theme\");\n\n    [].forEach.call(elements, function (element) {\n      if (element) {\n        element.disabled = true;\n        element.parentNode.removeChild(element);\n      }\n    });\n  }\n\n  /* Utilities */\n\n  generateUUID() {\n    var crypto = window.crypto || window.msCrypto;\n    if (crypto) {\n      var buf = new Uint32Array(4);\n      crypto.getRandomValues(buf);\n      var idx = -1;\n      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        idx++;\n        var r = buf[idx >> 3] >> idx % 8 * 4 & 15;\n        var v = c == 'x' ? r : r & 0x3 | 0x8;\n        return v.toString(16);\n      });\n    } else {\n      var d = new Date().getTime();\n      if (window.performance && typeof window.performance.now === \"function\") {\n        d += performance.now(); //use high-precision timer if available\n      }\n      var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        var r = (d + Math.random() * 16) % 16 | 0;\n        d = Math.floor(d / 16);\n        return (c == 'x' ? r : r & 0x3 | 0x8).toString(16);\n      });\n      return uuid;\n    }\n  }\n}\n\nwindow.ComponentManager = ComponentManager;\n\n\n},{}]},{},[1]);\n;'use strict';\n\nangular.module('app', [\n\n])\n;class HomeCtrl {\n  constructor($rootScope, $scope, $timeout) {\n\n    var permissions = [\n      {\n        name: \"stream-items\",\n        content_types: [\"Tag\"]\n      }\n    ]\n    let componentManager = new window.ComponentManager(permissions, function(){\n      // on ready\n    });\n\n    let delimiter = \".\";\n\n    $scope.resolveRawTags = function() {\n      var resolved = $scope.masterTag.rawTags.slice();\n\n      var findResolvedTag = function(title) {\n        for(var tag of $scope.masterTag.rawTags) {\n          if(tag.content.title === title) {\n            return tag;\n          }\n        }\n        return null;\n      }\n\n      for(var tag of $scope.masterTag.rawTags) {\n        tag.children = [];\n        tag.parent = null;\n      };\n\n      for(var tag of $scope.masterTag.rawTags) {\n        var name = tag.content.title;\n        var comps = name.split(delimiter);\n        tag.displayTitle = comps[comps.length -1];\n        if(comps.length == 1) {\n          tag.parent = $scope.masterTag;\n          continue;\n        }\n\n        var parentTitle = comps.slice(0, comps.length - 1).join(delimiter);\n        var parent = findResolvedTag(parentTitle);\n        if(!parent) {\n          continue;\n        }\n\n        parent.children.push(tag);\n        parent.children = parent.children.sort(function(a, b){return a.content.title > b.content.title});\n        tag.parent = parent;\n\n        // remove chid from master list\n        var index = resolved.indexOf(tag);\n        resolved.splice(index, 1);\n      }\n\n      resolved = resolved.sort(function(a, b){return a.content.title > b.content.title});\n      $scope.masterTag.children = resolved;\n    }\n\n    $scope.changeParent = function(sourceId, targetId) {\n      var source = $scope.masterTag.rawTags.filter(function(tag){\n        return tag.uuid === sourceId;\n      })[0];\n\n      var target = targetId === \"0\" ? $scope.masterTag : $scope.masterTag.rawTags.filter(function(tag){\n        return tag.uuid === targetId;\n      })[0];\n\n      if(target.parent === source) {\n        return;\n      }\n\n      var needsSave = [source];\n\n      var adjustChildren = function(source) {\n        for(var child of source.children) {\n          var newTitle = source.content.title + delimiter + child.content.title.split(delimiter).slice(-1)[0];\n          child.content.title = newTitle;\n          needsSave.push(child);\n          adjustChildren(child);\n        }\n      }\n\n      var newTitle;\n      if(target.master) {\n        newTitle = source.content.title.split(delimiter).slice(-1)[0];\n      } else {\n        newTitle = target.content.title + delimiter + source.content.title.split(delimiter).slice(-1)[0];\n      }\n      source.content.title = newTitle;\n      adjustChildren(source);\n      $scope.resolveRawTags();\n\n      componentManager.saveItems(needsSave);\n    }\n\n    $scope.createTag = function(tag) {\n      tag.content_type = \"Tag\";\n      var title;\n      if(tag.parent.master) {\n        title = tag.content.title;\n      } else {\n        title = tag.parent.content.title + delimiter + tag.content.title;\n      }\n      tag.content.title = title;\n      tag.dummy = false;\n      componentManager.createItem(tag);\n    }\n\n    $scope.selectTag = function(tag) {\n      if(tag.master) {\n        componentManager.clearSelection();\n      } else {\n        componentManager.selectItem(tag);\n      }\n\n      if($scope.selectedTag) {\n        $scope.selectedTag.selected = false;\n      }\n\n      if($scope.selectedTag === tag && !tag.master) {\n        tag.editing = true;\n      }\n      $scope.selectedTag = tag;\n      tag.selected = true;\n    }\n\n    $scope.saveTags = function(tags) {\n      componentManager.saveItems(tags);\n    }\n\n    componentManager.streamItems(function(newTags) {\n      $timeout(function(){\n        var allTags = $scope.masterTag ? $scope.masterTag.rawTags : [];\n        for(var tag of newTags) {\n          var existing = allTags.filter(function(tagCandidate){\n            return tagCandidate.uuid === tag.uuid;\n          })[0];\n          if(existing) {\n            Object.assign(existing, tag);\n          } else {\n            allTags.push(tag);\n          }\n        }\n\n        $scope.masterTag = {\n          master: true,\n          content: {\n            title: \"\"\n          },\n          displayTitle: \"All\",\n          rawTags: allTags,\n          uuid: \"0\"\n        }\n\n        $scope.resolveRawTags();\n      })\n    }.bind(this));\n\n    $scope.onTrashDrop = function(tagId) {\n      var tag = $scope.masterTag.rawTags.filter(function(tag){return tag.uuid === tagId})[0];\n      var deleteChain = [];\n\n      function addChildren(tag) {\n        deleteChain.push(tag);\n        for(var child of tag.children) {\n          addChildren(child);\n        }\n      }\n\n      addChildren(tag);\n\n      componentManager.deleteItems(deleteChain);\n    }\n  }\n\n}\n\n// required for firefox\nHomeCtrl.$$ngIsClass = true;\n\nangular.module('app').controller('HomeCtrl', HomeCtrl);\n;angular\n  .module('app')\n  .directive('mbAutofocus', ['$timeout', function($timeout) {\n    return {\n      restrict: 'A',\n      scope: {\n        shouldFocus: \"=\"\n      },\n      link : function($scope, $element) {\n        $timeout(function() {\n          if($scope.shouldFocus) {\n            $element[0].focus();\n          }\n        });\n      }\n    }\n  }]);\n;angular\n  .module('app')\n  .directive('draggable', function() {\n  return  {\n    scope: {\n      tagId: \"=\",\n      drop: '&',\n      isDraggable: \"=\"\n    },\n    link: function(scope, element, attrs) {\n      // 'ngInject';\n      var el = element[0];\n\n      el.draggable = scope.isDraggable;\n\n      var counter = 0;\n\n      el.addEventListener(\n        'dragstart',\n        function(e) {\n          counter = 0;\n          e.dataTransfer.effectAllowed = 'move';\n          e.dataTransfer.setData('TagId', JSON.stringify(scope.tagId));\n          this.classList.add('drag');\n          return false;\n        },\n        false\n      );\n\n      el.addEventListener(\n        'dragend',\n        function(e) {\n          this.classList.remove('drag');\n          this.classList.remove('over');\n          return false;\n        },\n        false\n      );\n\n      el.addEventListener(\n        'dragover',\n        function(e) {\n          e.dataTransfer.dropEffect = 'move';\n          // allows us to drop\n          if (e.preventDefault) e.preventDefault();\n          this.classList.add('over');\n          return false;\n        },\n        false\n      );\n\n      el.addEventListener(\n        'dragenter',\n        function(e) {\n          counter++;\n          this.classList.add('over');\n          return false;\n        },\n        false\n      );\n\n      el.addEventListener(\n        'dragleave',\n        function(e) {\n          counter--;\n           if (counter === 0) {\n             this.classList.remove('over');\n           }\n          return false;\n        },\n        false\n      );\n\n      el.addEventListener(\n        'dragexit',\n        function(e) {\n          // counter--;\n          //  if (counter === 0) {\n             this.classList.remove('over');\n          //  }\n          return false;\n        },\n        false\n      );\n\n      el.addEventListener(\n        'drop',\n        function(e) {\n\n          // Stops some browsers from redirecting.\n          counter = 0;\n          if (e.stopPropagation) e.stopPropagation();\n\n          this.classList.remove('over');\n\n          var targetId = JSON.parse(e.dataTransfer.getData('TagId'));\n          if(targetId === scope.tagId) {\n            return;\n          }\n          scope.$apply(function(scope) {\n            scope.drop()(targetId, scope.tagId);\n          });\n\n          return false;\n        },\n        false\n      );\n\n    }\n  }\n});\n;class TagTree {\n\n  constructor() {\n    this.restrict = \"C\";\n    this.templateUrl = \"directives/tag_tree.html\";\n    this.scope = {\n      tag: \"=\",\n      changeParent: \"&\",\n      onSelect: \"&\",\n      createTag: \"&\",\n      saveTags: \"&\"\n    };\n  }\n\n  controller($scope) {\n    'ngInject';\n\n    $scope.onDrop = function(sourceId, targetId) {\n      $scope.changeParent()(sourceId, targetId);\n    }\n\n    $scope.onDragOver = function(event) {\n      // console.log(\"onDragOver\", event);\n    }\n\n    $scope.onDragStart = function(event) {\n      // console.log(\"On drag start\", event);\n    }\n\n    $scope.selectTag = function() {\n      $scope.onSelect()($scope.tag);\n    }\n\n    $scope.addChild = function(parent) {\n      parent.children.unshift({dummy: true, parent: parent, content: {}})\n    }\n\n    $scope.saveNewTag = function(tag) {\n      if(tag.content.title.length === 0) {\n        tag.parent.children.slice(tag.parent.children.indexOf(tag), 0);\n        return;\n      }\n      $scope.createTag()(tag);\n    }\n\n    $scope.saveTagRename = function(tag) {\n      var delimiter = \".\";\n      var tags = [tag];\n      var title;\n      if(tag.parent.master) {\n        title = tag.displayTitle;\n      } else {\n        title = tag.parent.content.title + delimiter + tag.displayTitle;\n      }\n\n      tag.content.title = title;\n\n      function renameChildren(tag) {\n        for(var child of tag.children) {\n          child.content.title = child.parent.content.title + delimiter + child.displayTitle;\n          tags.push(child);\n          renameChildren(child);\n        }\n      }\n\n      renameChildren(tag);\n\n      tag.editing = false;\n\n      $scope.saveTags()(tags);\n    }\n\n    $scope.generationForTag = function(tag) {\n      var generation = 0;\n      var parent = tag.parent;\n      while(parent) {\n        generation++;\n        parent = parent.parent;\n      }\n      return generation;\n    }\n\n  }\n}\n\nTagTree.$$ngIsClass = true;\n\nangular.module('app').directive('tagTree', () => new TagTree);\n"]}